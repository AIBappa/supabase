_format_version: '2.1'
_transform: true

###
### Consumers (Secrets pulled from .env)
###
consumers:
  - username: anon
    keyauth_credentials:
      - key: $SUPABASE_ANON_KEY
  - username: service_role
    keyauth_credentials:
      - key: $SUPABASE_SERVICE_KEY

###
### Services (Matched to your container names)
###
services:
  ## Auth Service
  - name: auth-v1
    url: http://supabase-auth:9999/
    routes:
      - name: auth-v1-all
        strip_path: true
        paths: [/auth/v1/]

  ## REST Database API
  - name: rest-v1
    url: http://supabase-rest:3000/
    routes:
      - name: rest-v1-all
        strip_path: true
        paths: [/rest/v1/]

  ## Studio Dashboard
  - name: dashboard
    url: http://supabase-studio:3000/
    routes:
      - name: dashboard-all
        strip_path: true
        paths: [/]
